{% load static tailwind_tags %} 
<!DOCTYPE html> 
<html lang="es" style="background: #000a0e !important; background-color: #000a0e !important;"> 
<head> 
<meta charset="UTF-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;500;700&family=Space+Mono:wght@400;700&family=Inter:wght@300;400;500;600;700;800;900&family=Outfit:wght@300;400;500;600;700;800;900&family=Lexend:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<title>{% block title %}SaludTotal - Sistema Médico Avanzado{% endblock %}</title>
{% tailwind_css %}
<link rel="stylesheet" href="/static/dashboard/loader.css">
<link rel="stylesheet" href="/static/dashboard/base.css">
<script src="/static/dashboard/loader.js"></script>
{% block extra_head %}{% endblock %}
</head>
<body>
<!-- Loading Animado Futurista Global -->
{% include 'fragments/loader.html' %}
<!-- Fin Loader -->

<!-- Elimina el contenedor extra para evitar doble caja -->
{% block navBar %}
<header class="glass-header border-b border-cyan-400/20 sticky top-0 z-50 shadow-lg" style="
  backdrop-filter: blur(18px) !important;
  border-radius: 0.75rem !important;
  padding: 0.5rem 2.5rem 0.5rem 1rem !important;
  font-size: 0.875rem !important;
  font-weight: 500 !important;
  min-width: 10rem !important;
  transition: all 0.3s ease !important;
  appearance: none !important;
  background-image: url('data:image/svg+xml,%3csvg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"%3e%3cpath stroke="%2300f5ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 8l4 4 4-4"/%3e%3c/svg%3e') !important;
  background-position: right 0.5rem center !important;
  background-repeat: no-repeat !important;
  background-size: 1.5rem 1.5rem !important;
}">    <div class="max-w-7xl mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
            <!-- Logo y Título Neón -->
            <div class="flex items-center space-x-4">
                <div class="w-12 h-12 rounded-2xl flex items-center justify-center bg-gradient-to-r from-cyan-400 via-blue-600 to-purple-600 shadow-lg border border-cyan-400/30 cyber-glow">
                    <svg class="w-7 h-7 text-cyan-200 drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6m0 0l4-4m-4 4L8 8"></path>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-500 bg-clip-text text-transparent drop-shadow-[0_2px_12px_rgba(0,255,255,0.6)] glow-text">SaludTotal</h1>
                    <p class="text-sm text-cyan-200 cyber-glow">Sistema Médico Avanzado</p>
                </div>
            </div>
            <!-- User Profile / Login -->
            <div class="flex items-center space-x-4">
                {% if user.is_authenticated %}                    <!-- Groups Selector -->
                    <div class="relative">
                        <select id="groupSelect" aria-label="Seleccionar grupo de trabajo" class="cyber-input bg-cyan-950/80 border border-cyan-400/30 rounded-lg px-4 py-2 text-cyan-100 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 transition-all duration-300 shadow-md hover:shadow-cyan-500/20">
                            <option value="">Seleccionar Grupo</option>
                            {% for group in group_list %}
                                <option value="{{ group.id }}" {% if request.GET.gpid == group.id|stringformat:"s" %}selected{% endif %}>{{ group.name }}</option>
                            {% empty %}
                                <option value="" disabled>Sin grupos asignados</option>
                            {% endfor %}
                        </select>
                    </div>
                    <!-- User Dropdown -->
                    <div class="relative">
                        <button id="userDropdown" 
                                aria-expanded="false"
                                aria-haspopup="true"
                                aria-label="Menú de usuario" class="cyber-card flex items-center space-x-3 bg-cyan-950/80 rounded-full shadow-lg px-4 py-2 hover:shadow-cyan-400/30 transition-all duration-300 transform hover:scale-105 border border-cyan-400/20">
                            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center cyber-glow">
                                <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <div class="text-left">
                                <span class="text-cyan-100 font-medium block glow-text">{{ user.username }}</span>
                                {% if group_list.exists %}
                                    <span class="text-xs text-cyan-400 cyber-badge">{{ group.name }}</span>
                                {% endif %}
                            </div>
                            <svg class="w-4 h-4 text-cyan-400 transform transition-transform duration-200" id="userDropdownIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <!-- Dropdown Menu -->
                        <div id="userDropdownMenu" 
                             class="absolute right-0 mt-2 w-56 bg-cyan-950/95 rounded-xl shadow-xl border border-cyan-400/20 opacity-0 invisible transform scale-95 transition-all duration-200 z-50"
                             role="menu"
                             aria-labelledby="userDropdown">
                            <div class="py-2">
                                <!-- User Info -->
                                <div class="px-4 py-3 border-b border-cyan-400/10">
                                    <p class="text-sm font-medium text-cyan-100">{{ user.username }}</p>
                                    <p class="text-sm text-cyan-300">{{ user.email|default:"Sin email" }}</p>
                                    {% if user.group.exists %}
                                        <div class="mt-2">
                                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-cyan-400/20 text-cyan-200">
                                                {{ user.group.name }}
                                            </span>
                                        </div>
                                    {% endif %}
                                </div>
                                <!-- Menu Items -->
                                <a href="#" class="flex items-center px-4 py-2 text-sm text-cyan-100 hover:bg-cyan-800/40 transition-colors duration-200">
                                    <i class="fa-solid fa-user-gear w-4 h-4 mr-3 text-cyan-400"></i>
                                    Mi Perfil
                                </a>
                                <a href="#" class="flex items-center px-4 py-2 text-sm text-cyan-100 hover:bg-cyan-800/40 transition-colors duration-200">
                                    <i class="fa-solid fa-gear w-4 h-4 mr-3 text-cyan-400"></i>
                                    Configuración
                                </a>
                                <div class="border-t border-cyan-400/10 my-1"></div>
                                <form method="POST" action="{% url 'security:signout' %}" class="block">
                                    {% csrf_token %}
                                    <button type="submit" class="flex items-center w-full px-4 py-2 text-sm text-pink-400 hover:bg-pink-900/30 transition-colors duration-200">
                                        <i class="fa-solid fa-arrow-right-from-bracket w-4 h-4 mr-3 text-pink-400"></i>
                                        Cerrar Sesión
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>                {% else %}
                    <!-- Login Button -->
                    <a href="{% url 'security:signin' %}" class="cyber-btn flex items-center space-x-2 bg-gradient-to-r from-cyan-400 to-purple-500 hover:from-cyan-500 hover:to-pink-500 text-white font-medium px-6 py-2 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-cyan-400/30">
                        <i class="fa-solid fa-arrow-right-to-bracket w-4 h-4"></i>
                        <span>Acceso Quantum</span>
                    </a>
                {% endif %}
            </div>
        </div>
    </header>
    {% endblock navBar %} 

    <!-- Particles background -->
    <div class="particles-bg" id="particlesBg"></div>

    {% block content %}{% endblock content %}
    {% block js %}
    <script src="{% static 'dashboard/base.js' %}"></script>
    {% endblock %}
</body> 
</html>